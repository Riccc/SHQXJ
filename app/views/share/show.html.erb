<style>
    body {
        margin: 0;
        font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial;
        background-color: #f9f9f9;
    }

    #card {
        background-color: white;
        border-radius: 20px;
        box-shadow: 0 8px 20px rgba(0, 0, 0, 0.1);
        overflow: hidden;
        height: 100vh;
        width: 80%;
        max-width: 1000px;
        display: flex;
        background-size: cover;
        background-position: center;
    }

    #card-left {
        position: relative;
        flex: 1;
        padding: 32px 24px;
        border-radius: 30px;
        background-size: cover;
        background-position: center;
        background-repeat: no-repeat;
        display: flex;
        flex-direction: column; /* å‚ç›´å¸ƒå±€ */
        justify-content: center; /* å†…å®¹å‚ç›´å±…ä¸­ */
        align-items: center; /* å†…å®¹æ°´å¹³å±…ä¸­ */
        height: 100%;
    }

    #card-left::before {
        content: '';
        position: absolute;
        inset: 0;
        background: rgba(255, 255, 255, 0.6);
        z-index: 0;
    }

    #card-left > * {
        position: relative;
        z-index: 1;
    }

    #card-left h1 {
        font-size: 28px;
        font-weight: bold;
        color: #222;
        text-align: center;
        margin-bottom: 8px;
    }

    #card-left h2 {
        font-size: 20px;
        color: #333;
        margin: 16px 0 8px;
    }

    #card-left p {
        font-size: 15px;
        color: #444;
        line-height: 1.5;
        text-align: center;
        margin-bottom: 6px;
    }

    .avatar-wrapper {
        display: flex;
        justify-content: center;
        margin: 20px 0;
    }

    .avatar {
        width: 100px;
        height: 100px;
        border-radius: 50%;
        border: 3px solid white;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);
        object-fit: cover;
    }

    #A {
        display: flex;
        flex-wrap: wrap;
        gap: 16px;
        justify-content: space-between;
        width: 100%;
    }

    #B, #C {
        flex: 1;
        min-width: 45%;
        text-align: center;
    }

    #D img {
        height: 50px;
    }

    .qr-section {
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        background: white;
        width: 220px;
        padding: 24px;
        border-left: 1px solid #eee;
        height: 100%;
        padding-top: 50px; /* ç»™äºŒç»´ç åŒºåŸŸæ·»åŠ é¡¶éƒ¨é—´è· */
    }

    .qr-section img {
        width: 100px;
        height: 100px;
        margin-bottom: 16px;
        border-radius: 10px;
    }

    .retry-button {
        padding: 12px 20px;
        background: #FF8C00;
        color: white;
        font-size: 16px;
        border-radius: 12px;
        text-decoration: none;
        transition: background 0.3s;
        font-weight: bold;
        width: 100%;
        max-width: 200px;
        text-align: center;
        margin-top: 20px;
    }

    .retry-button:hover {
        background: #e67e00;
    }

</style>

<div style="background-color: transparent; height: 97vh; display: flex; justify-content: center; align-items: center;">
  <div id="card" style="display: flex; justify-content: space-between; align-items: flex-start;">
    <!-- å¡ç‰‡å·¦ä¾§ -->
    <div id="card-left" style="background-image: url('<%= asset_path('user-share.jpeg') %>');">
      <h1>æˆ‘æ˜¯å°å°é¢„æŠ¥å‘˜</h1>
      <p>ä»Šå¤©æˆ‘åœ¨ä¸Šæµ·æ°”è±¡åšç‰©é¦†é¢„æŠ¥å¤©æ°”</p>

      <div class="avatar-wrapper">
        <img id="share-avatar" src="" alt="å¤´åƒ" style="width: 80px; height: 80px; border-radius: 50%;" />
      </div>

      <h2 style="font-size: 30px; margin-bottom: 12px;"><strong><%= @name %></strong></h2>

      <div style="display: flex; flex-direction: column; gap: 30px; width: 100%;">

        <!-- æˆ‘çš„é¢„æŠ¥å¡ç‰‡ -->
        <div style="width: 90%; display: flex; background-color: rgba(240, 248, 255, 0.8); padding: 20px; border-radius: 16px; box-shadow: 0 4px 12px rgba(0,0,0,0.1);">
          <div style="flex: 2;">
            <h2 style="font-size: 20px; margin-bottom: 12px;">ğŸŒ¤ æˆ‘çš„é¢„æŠ¥</h2>
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 8px;">
              <div>æ—¥æœŸï¼š<%= @chosen_date %></div>
              <div>æ°”æ¸©ï¼š<%= @low_temp %>â„ƒï½<%= @high_temp %>â„ƒ</div>
              <div>å¤©æ°”æè¿°ï¼š<%= @chosen_text %></div>
              <div>ä¸ªæ€§æ–‡æ¡ˆï¼š<%= @selected_text_content %></div>
            </div>
          </div>
          <div style="flex: 1; display: flex; align-items: center; justify-content: center;">
            <%= image_tag @chosen_img, id: 'chosen_img', style: "max-width: 100px;" %>
          </div>
        </div>

        <!-- ç”Ÿæ—¥å¤©æ°”å¡ç‰‡ -->
        <div style="width: 90%; display: flex; background-color: rgba(255, 250, 240, 0.8); border-radius: 16px; padding: 20px 24px; box-shadow: 0 4px 12px rgba(0,0,0,0.1);">
          <div style="flex: 2;">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
              <h2 style="font-size: 20px;">ğŸ‚ ç”Ÿæ—¥å¤©æ°”</h2>
              <p style="font-size: 16px; color: #333;"><strong><%= @birthday %></strong></p>
            </div>

            <% if @birthday_weather_data.present? %>
              <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 16px;">
                <div>å¹³å‡æ°”æ¸©ï¼š<%= @birthday_weather_data[:avg_temp] %>â„ƒ</div>
                <div>æœ€é«˜æ°”æ¸©ï¼š<%= @birthday_weather_data[:max_temp] %>â„ƒ</div>
                <div>æœ€ä½æ°”æ¸©ï¼š<%= @birthday_weather_data[:min_temp] %>â„ƒ</div>
                <div>é™æ°´é‡ï¼š<%= @birthday_weather_data[:precipitation] %> mm</div>
                <div>é£é€Ÿï¼š<%= @birthday_weather_data[:wind_speed] %> m/s</div>
                <div>æ¹¿åº¦ï¼š<%= @birthday_weather_data[:humidity] %> %</div>
                <div>å¤©æ°”ï¼š<%= @birthday_weather_data[:weather_summary] %></div>
                <div>é›¨é‡ç±»å‹ï¼š<%= @birthday_weather_data[:rainfall_type] %></div>
              </div>
            <% else %>
              <p style="color: #888; margin-top: 15px;">è¶…å‡ºæ•°æ®èŒƒå›´å•¦ï¼Œä½†æˆ‘ä»¬ç›¸ä¿¡é‚£å¤©çš„ä½ ç¬‘å¾—æ¯”é˜³å…‰è¿˜ç¿çƒ‚ â˜€ï¸</p>
            <% end %>
          </div>

          <!-- å³ä¾§ç©ºç™½åŒºåŸŸï¼Œç”¨äºä¿æŒå¸ƒå±€ -->
          <div style="flex: 1; display: flex; align-items: center; justify-content: center;">
            <div style="width: 100px; height: 100px;"></div>
          </div>
        </div>

      </div>




    </div>

    <!-- å¡ç‰‡å³ä¾§ï¼ˆäºŒç»´ç å’ŒæŒ‰é’®ï¼‰ -->
    <div class="qr-section" style="display: flex; flex-direction: column; justify-content: center; align-items: center; background: white; width: 220px; padding: 24px; border-left: 1px solid #eee; height: 100%;">
      <%= image_tag 'shareQRcode.png', style: 'width: 100px; height: 100px; margin-bottom: 16px;' %>
      <%= link_to 'å†è¯•ä¸€æ¬¡', root_path, class: 'retry-button' %>
    </div>
  </div>
</div>




<script>
    document.addEventListener("DOMContentLoaded", function() {
        const cardLeft = document.getElementById("card-left");
        const shareAvatar = document.getElementById("share-avatar");

        const uploadedImage = localStorage.getItem("uploadedImage");
        const uploadedBackgroundImage = localStorage.getItem("uploadedBackgroundImage");

        // è®¾ç½®å¤´åƒ
        if (uploadedImage && shareAvatar) {
            shareAvatar.src = uploadedImage;
            shareAvatar.style.display = "block";  // ç¡®ä¿å¤´åƒæ˜¾ç¤º
        } else {
            shareAvatar.style.display = "none"; // å¦‚æœæ²¡æœ‰å¤´åƒåˆ™éšè—
        }

        // è®¾ç½®èƒŒæ™¯å›¾
        if (uploadedBackgroundImage && cardLeft) {
            cardLeft.style.backgroundImage = `url(${uploadedBackgroundImage})`;
            cardLeft.style.backgroundSize = "cover";
            cardLeft.style.backgroundPosition = "center";
        } else {
            // è®¾ç½®é»˜è®¤èƒŒæ™¯
            cardLeft.style.backgroundImage = "url('<%= asset_path('user-share.jpeg') %>')";
        }
    });
</script>
